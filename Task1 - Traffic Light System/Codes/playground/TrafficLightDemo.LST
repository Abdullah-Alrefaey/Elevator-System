A51 MACRO ASSEMBLER  TRAFFICLIGHTDEMO                                                     03/19/2020 02:59:12 PAGE     1


MACRO ASSEMBLER A51 V8.02
OBJECT MODULE PLACED IN TrafficLightDemo.OBJ
ASSEMBLER INVOKED BY: C:\Keil\C51\BIN\A51.EXE TrafficLightDemo.A51 SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

  0100                 1             TABLE_RIGHT EQU 100H                    ; start address of look-up Table
  0200                 2                     TABLE_LEFT EQU 200H
  0096                 3                     RED BIT P1.6
  0095                 4                     GREEN BIT P1.5
  00B0                 5                     LEFT_SEGMENT EQU P3
  00A0                 6                     RIGHT_SEGMENT EQU P2
                       7                     
0000                   8                     ORG 0                                   ;tells the compiler all subsequent 
                             code starting at address 0
0000 900100            9                     MOV DPTR, #TABLE_RIGHT
0003 7402             10                     MOV A, #2                               ;max left segment
0005 F9               11                     MOV R1, A
0006 93               12                     MOVC A, @A+DPTR
0007 75B05B           13                     MOV LEFT_SEGMENT, #5BH
000A 113C             14                     CALL ON
000C 7403             15                     MOV A, #3                               ;MSB Tracker, Max Left Segment + 1
000E FA               16                     MOV R2, A
                      17     
                      18                     
000F 7409             19     MAIN:   MOV A, #9
0011 F8               20                     MOV R0, A
                      21     
0012 93               22     LOOP3:  MOVC A, @A+DPTR                 ; location in the look-up Table
0013 F5A0             23                     MOV RIGHT_SEGMENT, A    ; write to the 7-segment
0015 18               24                     DEC R0
0016 E8               25                     MOV A, R0
0017 310A             26                     ACALL DELAY_1s
0019 B800F6           27                     CJNE R0, #0H, LOOP3             ; check the number
001C 1A               28                     DEC R2
                      29     
001D 93               30                     MOVC A, @A+DPTR
001E F5A0             31                     MOV RIGHT_SEGMENT, A
0020 310A             32                     ACALL DELAY_1s
0022 BA0004           33                     CJNE R2, #0, LCONT
0025 1130             34                     CALL REST
0027 80E6             35                     JMP MAIN
                      36     
0029 19               37     LCONT:  DEC R1
002A E9               38                     MOV A, R1
002B 93               39                     MOVC A, @A+DPTR
002C F5B0             40                     MOV LEFT_SEGMENT, A
                      41     
                      42                     
002E 80DF             43                     JMP MAIN
                      44     
                      45     
                      46     
0030 7402             47     REST:   MOV A, #2                               ;max left segment
0032 F9               48                     MOV R1, A
0033 93               49                     MOVC A, @A+DPTR
0034 F5B0             50                     MOV LEFT_SEGMENT,  A
0036 1146             51                     CALL TOG
0038 7403             52                     MOV A, #3                               ;Reset Tracker
003A FA               53                     MOV R2, A
003B 22               54                     RET
                      55     
003C D295             56     ON:             SETB GREEN
003E C296             57                     CLR RED
A51 MACRO ASSEMBLER  TRAFFICLIGHTDEMO                                                     03/19/2020 02:59:12 PAGE     2

0040 22               58                     RET
                      59                     
0041 C295             60     OFF:    CLR GREEN
0043 D296             61                     SETB RED
0045 22               62                     RET
0046 B295             63     TOG:    CPL GREEN
0048 B296             64                     CPL RED
004A 22               65                     RET                             
                      66     
                      67                                     ;look up table for right seven segment common cathode
0100                  68             ORG TABLE_RIGHT
0100 3F065B4F         69             DB 3FH,06H,5BH,4FH,66H,6DH,7DH,07H,7FH,6FH
0104 666D7D07                
0108 7F6F                    
                      70     
                      71     
010A 7C07             72     DELAY_1s:       MOV R4, #7                      ; delay 1s ---> (256 * 256 * 24 * 8 + 24) /
                              12000000
010C 7D00             73                             MOV R5, #0
010E 7E00             74                             MOV R6, #0
0110 DEFE             75     LOOP2:          DJNZ R6, LOOP2
0112 DDFC             76                             DJNZ R5, LOOP2
0114 DCFA             77                             DJNZ R4, LOOP2
0116 22               78                             RET
                      79     
                      80     
                      81                     END
A51 MACRO ASSEMBLER  TRAFFICLIGHTDEMO                                                     03/19/2020 02:59:12 PAGE     3

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

DELAY_1S . . . . .  C ADDR   010AH   A   
GREEN. . . . . . .  B ADDR   0090H.5 A   
LCONT. . . . . . .  C ADDR   0029H   A   
LEFT_SEGMENT . . .  D ADDR   00B0H   A   
LOOP2. . . . . . .  C ADDR   0110H   A   
LOOP3. . . . . . .  C ADDR   0012H   A   
MAIN . . . . . . .  C ADDR   000FH   A   
OFF. . . . . . . .  C ADDR   0041H   A   
ON . . . . . . . .  C ADDR   003CH   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . .  D ADDR   00B0H   A   
RED. . . . . . . .  B ADDR   0090H.6 A   
REST . . . . . . .  C ADDR   0030H   A   
RIGHT_SEGMENT. . .  D ADDR   00A0H   A   
TABLE_LEFT . . . .  N NUMB   0200H   A   
TABLE_RIGHT. . . .  N NUMB   0100H   A   
TOG. . . . . . . .  C ADDR   0046H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
